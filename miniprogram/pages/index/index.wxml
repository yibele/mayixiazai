<!-- miniprogram/pages/index/index.wxml -->
<view class="page-container">
  <t-toast id="t-toast" />
  <t-dialog id="t-dialog" />

  <!-- Logo 和标题 -->
  <view class="header">
    <t-image class="logo" src="https://pic.616pic.com/ys_b_img/00/33/91/IVfRe2v2aW.jpg" mode="aspectFit" />
    <view class="title">蚂蚁下载</view>
    <view class="subtitle">轻松去除视频水印，提取精彩文案</view>
  </view>

  <!-- 输入区域 -->
  <view class="input-card">
    <t-input
      class="input-field"
      value="{{link}}"
      bind:change="onLinkInput"
      placeholder="请在此处粘贴视频或图文分享链接"
      clearable
      prefix-icon="link"
    />
    <t-button
      class="parse-button"
      theme="primary"
      block
      loading="{{isLoading}}"
      bind:tap="startParse"
    >
      开始分析
    </t-button>
  </view>

  <!-- 加载状态 -->
  <view class="loading-container" wx:if="{{isLoading}}">
    <t-loading text="正在为您努力解析中..." size="40rpx" />
  </view>

  <!-- 解析结果 -->
  <view class="result-card" wx:if="{{!isLoading && videoInfo}}">
    <t-image class="video-cover" src="{{videoInfo.cover}}" mode="aspectFill" />
    <view class="video-details">
      <view class="video-title">{{videoInfo.title}}</view>
      <view class="author-info">
        <t-avatar size="small" image="{{videoInfo.authorAvatar}}" />
        <view class="author-name">{{videoInfo.author}}</view>
      </view>
    </view>
    <view class="action-buttons">
      <t-button theme="primary" variant="outline" block bind:tap="copyCaption">
        <t-icon name="file-copy" slot="icon"/>
        复制文案
      </t-button>
      <t-button theme="primary" block bind:tap="downloadVideo">
        <t-icon name="download" slot="icon"/>
        下载视频
      </t-button>
    </view>
  </view>

  <!-- 历史记录入口 -->
  <view class="history-entry" bind:tap="navigateToHistory">
    <t-icon name="history" />
    <text>解析历史</text>
  </view>

  <!-- 页脚 -->
  <t-footer
    class="page-footer"
    text="本服务仅供个人学习与收藏，请勿用于商业用途。"
  ></t-footer>
</view>
