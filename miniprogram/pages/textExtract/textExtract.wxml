<!-- miniprogram/pages/textExtract/textExtract.wxml -->
<view class="page-container">
  <t-dialog id="t-dialog" />

  <!-- TDesign导航栏 -->
  <t-navbar title="文案提取" left-arrow fixed bind:left-click="goBack" />

  <!-- 功能说明 -->
  <view class="intro-card">
    <view class="intro-title">
      <t-icon name="file-text" size="32rpx" color="#1976d2" />
      <text>文案提取功能</text>
    </view>
    <view class="intro-desc">
      输入视频链接，快速提取视频原文案，支持一键复制到剪贴板。
    </view>
  </view>

  <!-- 输入区域 -->
  <view class="input-card">
    <t-input
      class="input-field"
      value="{{link}}"
      bind:change="onLinkInput"
      placeholder="请在此处粘贴视频分享链接"
      clearable
      prefix-icon="link"
    />
    <!-- 按钮组 -->
    <view class="button-group">
      <t-button
        class="action-btn"
        theme="primary"
        loading="{{isLoading}}"
        bind:tap="extractText"
      >
        提取文案
      </t-button>
      <t-button
        class="action-btn"
        theme="default"
        bind:tap="pasteFromClipboard"
      >
        一键粘贴
      </t-button>
    </view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-container" wx:if="{{isLoading}}">
    <t-loading text="正在提取文案中..." size="40rpx" />
  </view>

  <!-- 提取结果 -->
  <view class="result-card" wx:if="{{!isLoading && textContent}}">
    <view class="result-header">
      <view class="result-title">提取到的文案</view>
      <t-button
        size="small"
        theme="primary"
        variant="outline"
        bind:tap="copyText"
      >
        <t-icon name="file-copy" slot="icon" size="24rpx" />
        复制
      </t-button>
    </view>
    <view class="text-content">{{textContent}}</view>
  </view>

  <!-- 历史记录 -->
  <view class="history-section" wx:if="{{historyList.length > 0}}">
    <view class="section-title">
      <t-icon name="time" size="28rpx" color="#666" />
      <text>提取历史</text>
    </view>
    <view class="history-list">
      <view class="history-item" wx:for="{{historyList}}" wx:key="index">
        <view class="history-text">{{item.text}}</view>
        <view class="history-time">{{item.time}}</view>
        <t-button
          size="small"
          theme="default"
          variant="outline"
          bind:tap="copyHistoryText"
          data-text="{{item.text}}"
        >
          复制
        </t-button>
      </view>
    </view>
  </view>
</view>